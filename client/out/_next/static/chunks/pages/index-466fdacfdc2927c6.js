(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4369)}])},9080:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(5893),a=n(6076),s=n(9485),i=n(7294),l=n(8392),c=n(5447),o=n(3680),d=n(5147),u=n(7160),h=n.n(u);function x(e){let[t,n]=(0,i.useState)(!1),[u,x]=(0,i.useState)([]),[j,w]=(0,i.useState)(null),[f,m]=(0,i.useState)(""),[v,g]=(0,i.useState)(""),[p,y]=(0,i.useState)(""),[C,b]=(0,i.useState)(""),N="0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC",S=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){let n=e.provider.getSigner();return new a.CH(l.I,l.d,n)}return new a.CH(l.I,l.d,e.provider)},Z=async()=>{let e=await S(!0),t=await e.getTokenIds();for(var r=[],a=0;a<t.length;a++){var s=t[a].toNumber();if(0!=s){let i=await e.getTokenAttrs(t[a]);r.push({tokenId:s,product:i[3],quantity:i[2],unit:i[4],state:i[5]})}}x(r),n(!1)},k=async()=>{try{let e=Date.now(),t=await S(!0),r=await t.mint(0,e,p,v,C);n(!0),await r.wait()}catch(a){console.log(a),window.alert("There was an error with the mint!")}},I=e=>{e.preventDefault(),k(),w(null),m(""),y(""),g(""),b("")},E=async()=>{try{let e=await S(!0),t=await e.transferToBaker(N,f);n(!0),await t.wait()}catch(r){console.log(r),window.alert("There was an error with transfer")}},_=(e,t)=>{j==t?(w(null),m("")):(w(t),m(e))},T=e=>{switch(e){case 0:return"New";case 1:return"Delivered";case 2:return"Accepted";case 3:return"Rejected"}};return(0,i.useEffect)(()=>{var t;let r=new a.CH(l.I,l.d,e.provider);return e.provider.send("eth_requestAccounts",[]).then(function(e){t=s.Kn(e[0])}),async function(){n(!0),await Z()}(),r.on(r.filters.Transaction(t,null,0),async(e,t,r)=>{n(!0),await Z()}),r.on(r.filters.Transaction(N,null,[1,3]),async(e,t,r)=>{n(!0),await Z()}),()=>{e.provider.removeAllListeners()}},[e]),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:h().main,children:[(0,r.jsxs)("div",{className:h().title,children:[(0,r.jsx)("img",{width:100,height:100,src:"/farmerColor.png",alt:"farmer icon"}),(0,r.jsx)("h2",{children:"Farmer User Account"})]}),(0,r.jsxs)(d.Z,{striped:!0,bordered:!0,hover:!0,className:h().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Select"}),(0,r.jsx)("th",{children:"Token ID"}),(0,r.jsx)("th",{children:"Product Name"}),(0,r.jsx)("th",{children:"Quantity"}),(0,r.jsx)("th",{children:"Unit"}),(0,r.jsx)("th",{children:"State"})]})}),(0,r.jsx)("tbody",{children:t?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{style:{"--bs-table-accent-bg":"white",textAlign:"center"},colSpan:"6",children:[(0,r.jsx)("img",{src:"./loading.gif",alt:"loading..."}),(0,r.jsx)("p",{className:h().p_no_margin,children:"Loading, wait some seconds..."})]})}):u.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)(c.Z.Check,{type:"radio",id:e.tokenId,value:e.tokenId,name:"selectedToken",checked:j==t,readOnly:!0,onClick:e=>_(e.target.value,t)})}),(0,r.jsx)("td",{children:e.tokenId}),(0,r.jsx)("td",{children:e.product}),(0,r.jsx)("td",{children:e.quantity}),(0,r.jsx)("td",{children:e.unit}),(0,r.jsx)("td",{children:T(e.state)})]},t))})]}),(0,r.jsxs)("div",{className:h().flexContainer,children:[(0,r.jsx)("div",{className:h().form,children:(0,r.jsxs)(c.Z,{onSubmit:I,children:[(0,r.jsx)("h4",{children:"Mint"}),(0,r.jsxs)(c.Z.Group,{className:"mb-3",controlId:"productName",children:[(0,r.jsx)(c.Z.Label,{children:"Product Name"}),(0,r.jsx)(c.Z.Control,{placeholder:"Enter name of product",value:v,onChange:e=>g(e.target.value)})]}),(0,r.jsxs)(c.Z.Group,{className:"mb-3",controlId:"quantity",children:[(0,r.jsx)(c.Z.Label,{children:"Quantity"}),(0,r.jsx)(c.Z.Control,{placeholder:"Enter quantity",value:p,onChange:e=>y(e.target.value)})]}),(0,r.jsx)(c.Z.Group,{className:"mb-3",controlId:"unit",children:(0,r.jsxs)(c.Z.Select,{value:C,onChange:e=>b(e.target.value),children:[(0,r.jsx)("option",{children:"Select unit"}),(0,r.jsx)("option",{value:"Kgs",children:"Kgs"}),(0,r.jsx)("option",{value:"L",children:"L"}),(0,r.jsx)("option",{value:"Unit",children:"Unit"})]})}),(0,r.jsx)(o.Z,{variant:"primary",type:"submit",disabled:""==v||""==p||""==C,children:"Mint"})]})}),(0,r.jsxs)("div",{className:h().form,children:[(0,r.jsx)("h4",{children:"Transfers"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Select first the token to transfer"}),(0,r.jsx)(o.Z,{variant:"primary",onClick:E,disabled:""==f,children:"Transfer to baker"})]})]})]})]})})}n(1535)},4369:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(5893),a=n(9008),s=n.n(a),i=n(7160),l=n.n(i),c=n(7114),o=n(9485),d=n(6076),u=n(7294),h=n(2484),x=n.n(h),j=n(8392),w=n(2987),f=n(9080),m=n(822),v=n(9326);function g(){let[e,t]=(0,u.useState)(!1),[n,a]=(0,u.useState)(null),[i,h]=(0,u.useState)(null),[g,p]=(0,u.useState)(!1),y=(0,u.useRef)(),C=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=await y.current.connect(),n=new c.Q(t),{chainId:r}=await n.getNetwork();if(5!=r)throw window.alert("Please switch to the Goerli network!"),Error("Incorrect network");if(e){let a=n.getSigner();return a}return n},b=async()=>{try{let e=await C();a(e),t(!0)}catch(n){console.log(n)}},N=async()=>{await b(),window.ethereum.on("accountsChanged",async function(e){if(e[0]){let n=o.Kn(e[0]),r=await S(n);h(r)}else t(!1),h(null),setShowU(!1)})},S=async e=>{try{let t=await C(),n=new d.CH(j.I,j.d,t);if(await n.owner()==e)return 3;{let r=await n.getUserRole(e);return r}}catch(a){console.log(a)}},Z=async()=>{try{let e=await n.send("eth_requestAccounts",[]),t=o.Kn(e[0]),r=await S(t);h(r)}catch(a){console.log(a)}};return(0,u.useEffect)(()=>{(async function(){e||(y.current=new(x())({network:"goerli",providerOptions:{},disableInjectedProvider:!1}),await N())})()}),(0,u.useEffect)(()=>{n&&async function(){await Z()}()},[n]),(0,u.useEffect)(()=>{null!=i&&p(!0)},[i]),(0,r.jsxs)("div",{className:l().container,children:[(0,r.jsx)(s(),{children:(0,r.jsx)("title",{children:"Transparency SC"})}),(0,r.jsx)("div",{children:g?(()=>{switch(i){case 0:return(0,r.jsx)(f.default,{provider:n});case 1:return(0,r.jsx)(m.default,{provider:n});case 2:return(0,r.jsx)(v.default,{provider:n});case 3:return(0,r.jsx)(w.default,{provider:n})}})():(0,r.jsx)("h3",{className:"".concat(l().main," ").concat(l().connect_wallet),children:"Connecting to a wallet..."})})]})}},2987:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(5893),a=n(7160),s=n.n(a),i=n(6076),l=n(7294),c=n(8392),o=n(5447),d=n(3680);function u(e){let[t,n]=(0,l.useState)(""),[a,u]=(0,l.useState)(""),[h,x]=(0,l.useState)(""),[j,w]=(0,l.useState)(""),f=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){let n=e.provider.getSigner();return new i.CH(c.I,c.d,n)}return new i.CH(c.I,c.d,e.provider)},m=e=>{switch(e){case"Farmer":return 0;case"Baker":return 1;case"Customer":return 2}},v=async()=>{try{let e=await f(!0);await e.registerUser(t,a,j,Date.now(),m(h))}catch(n){console.log(n),window.alert("There was an error while registering user")}},g=e=>{e.preventDefault(),v(),n(""),u(""),x(""),w("")};return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:s().main,children:[(0,r.jsx)("h2",{children:"Admin User Account"}),(0,r.jsx)("div",{className:s().form,children:(0,r.jsxs)(o.Z,{onSubmit:g,children:[(0,r.jsx)("h4",{children:"Sign User"}),(0,r.jsxs)(o.Z.Group,{className:"mb-3",controlId:"adress",children:[(0,r.jsx)(o.Z.Label,{children:"Account address"}),(0,r.jsx)(o.Z.Control,{placeholder:"Enter account address",value:t,onChange:e=>n(e.target.value)})]}),(0,r.jsxs)(o.Z.Group,{className:"mb-3",controlId:"userName",children:[(0,r.jsx)(o.Z.Label,{children:"Name"}),(0,r.jsx)(o.Z.Control,{placeholder:"Enter user name",value:a,onChange:e=>u(e.target.value)})]}),(0,r.jsxs)(o.Z.Group,{className:"mb-3",controlId:"role",children:[(0,r.jsx)(o.Z.Label,{children:"Role"}),(0,r.jsx)(o.Z.Control,{placeholder:"Enter role",value:h,onChange:e=>x(e.target.value)})]}),(0,r.jsxs)(o.Z.Group,{className:"mb-3",controlId:"formBasicEmail",children:[(0,r.jsx)(o.Z.Label,{children:"Location"}),(0,r.jsx)(o.Z.Control,{placeholder:"Enter location",value:j,onChange:e=>w(e.target.value)})]}),(0,r.jsx)(d.Z,{variant:"primary",type:"submit",children:"Register User"})]})})]})})}n(1535)}},function(e){e.O(0,[501,277,895,954,218,458,326,822,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);