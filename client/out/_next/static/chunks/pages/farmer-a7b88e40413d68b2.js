(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{2826:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/farmer",function(){return n(9080)}])},9080:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(5893),a=n(6076),s=n(9485),i=n(7294),l=n(8392),c=n(5447),d=n(3680),o=n(5147),h=n(7160),u=n.n(h);function x(e){let[t,n]=(0,i.useState)(!1),[h,x]=(0,i.useState)([]),[j,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(""),[v,w]=(0,i.useState)(""),[g,b]=(0,i.useState)(""),[y,N]=(0,i.useState)(""),k="0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC",C=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){let n=e.provider.getSigner();return new a.CH(l.I,l.d,n)}return new a.CH(l.I,l.d,e.provider)},S=async()=>{let e=await C(!0),t=await e.getTokenIds();for(var r=[],a=0;a<t.length;a++){var s=t[a].toNumber();if(0!=s){let i=await e.getTokenAttrs(t[a]);r.push({tokenId:s,product:i[3],quantity:i[2],unit:i[4],state:i[5]})}}x(r),n(!1)},_=async()=>{try{let e=Date.now(),t=await C(!0),r=await t.mint(0,e,g,v,y);n(!0),await r.wait()}catch(a){console.log(a),window.alert("There was an error with the mint!")}},Z=e=>{e.preventDefault(),_(),f(null),m(""),b(""),w(""),N("")},T=async()=>{try{let e=await C(!0),t=await e.transferToBaker(k,p);n(!0),await t.wait()}catch(r){console.log(r),window.alert("There was an error with transfer")}},$=(e,t)=>{j==t?(f(null),m("")):(f(t),m(e))},I=e=>{switch(e){case 0:return"New";case 1:return"Delivered";case 2:return"Accepted";case 3:return"Rejected"}};return(0,i.useEffect)(()=>{var t;let r=new a.CH(l.I,l.d,e.provider);return e.provider.send("eth_requestAccounts",[]).then(function(e){t=s.Kn(e[0])}),async function(){n(!0),await S()}(),r.on(r.filters.Transaction(t,null,0),async(e,t,r)=>{n(!0),await S()}),r.on(r.filters.Transaction(k,null,[1,3]),async(e,t,r)=>{n(!0),await S()}),()=>{e.provider.removeAllListeners()}},[e]),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:u().main,children:[(0,r.jsxs)("div",{className:u().title,children:[(0,r.jsx)("img",{width:100,height:100,src:"/farmerColor.png",alt:"farmer icon"}),(0,r.jsx)("h2",{children:"Farmer User Account"})]}),(0,r.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,className:u().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Select"}),(0,r.jsx)("th",{children:"Token ID"}),(0,r.jsx)("th",{children:"Product Name"}),(0,r.jsx)("th",{children:"Quantity"}),(0,r.jsx)("th",{children:"Unit"}),(0,r.jsx)("th",{children:"State"})]})}),(0,r.jsx)("tbody",{children:t?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{style:{"--bs-table-accent-bg":"white",textAlign:"center"},colSpan:"6",children:[(0,r.jsx)("img",{src:"./loading.gif",alt:"loading..."}),(0,r.jsx)("p",{className:u().p_no_margin,children:"Loading, wait some seconds..."})]})}):h.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)(c.Z.Check,{type:"radio",id:e.tokenId,value:e.tokenId,name:"selectedToken",checked:j==t,readOnly:!0,onClick:e=>$(e.target.value,t)})}),(0,r.jsx)("td",{children:e.tokenId}),(0,r.jsx)("td",{children:e.product}),(0,r.jsx)("td",{children:e.quantity}),(0,r.jsx)("td",{children:e.unit}),(0,r.jsx)("td",{children:I(e.state)})]},t))})]}),(0,r.jsxs)("div",{className:u().flexContainer,children:[(0,r.jsx)("div",{className:u().form,children:(0,r.jsxs)(c.Z,{onSubmit:Z,children:[(0,r.jsx)("h4",{children:"Mint"}),(0,r.jsxs)(c.Z.Group,{className:"mb-3",controlId:"productName",children:[(0,r.jsx)(c.Z.Label,{children:"Product Name"}),(0,r.jsx)(c.Z.Control,{placeholder:"Enter name of product",value:v,onChange:e=>w(e.target.value)})]}),(0,r.jsxs)(c.Z.Group,{className:"mb-3",controlId:"quantity",children:[(0,r.jsx)(c.Z.Label,{children:"Quantity"}),(0,r.jsx)(c.Z.Control,{placeholder:"Enter quantity",value:g,onChange:e=>b(e.target.value)})]}),(0,r.jsx)(c.Z.Group,{className:"mb-3",controlId:"unit",children:(0,r.jsxs)(c.Z.Select,{value:y,onChange:e=>N(e.target.value),children:[(0,r.jsx)("option",{children:"Select unit"}),(0,r.jsx)("option",{value:"Kgs",children:"Kgs"}),(0,r.jsx)("option",{value:"L",children:"L"}),(0,r.jsx)("option",{value:"Unit",children:"Unit"})]})}),(0,r.jsx)(d.Z,{variant:"primary",type:"submit",disabled:""==v||""==g||""==y,children:"Mint"})]})}),(0,r.jsxs)("div",{className:u().form,children:[(0,r.jsx)("h4",{children:"Transfers"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Select first the token to transfer"}),(0,r.jsx)(d.Z,{variant:"primary",onClick:T,disabled:""==p,children:"Transfer to baker"})]})]})]})]})})}n(1535)},5147:function(e,t,n){"use strict";var r=n(4184),a=n.n(r),s=n(7294),i=n(6792),l=n(5893);let c=s.forwardRef(({bsPrefix:e,className:t,striped:n,bordered:r,borderless:s,hover:c,size:d,variant:o,responsive:h,...u},x)=>{let j=(0,i.vE)(e,"table"),f=a()(t,j,o&&`${j}-${o}`,d&&`${j}-${d}`,n&&`${j}-${"string"==typeof n?`striped-${n}`:"striped"}`,r&&`${j}-bordered`,s&&`${j}-borderless`,c&&`${j}-hover`),p=(0,l.jsx)("table",{...u,className:f,ref:x});if(h){let m=`${j}-responsive`;return"string"==typeof h&&(m=`${m}-${h}`),(0,l.jsx)("div",{className:m,children:p})}return p});t.Z=c}},function(e){e.O(0,[501,895,458,774,888,179],function(){return e(e.s=2826)}),_N_E=e.O()}]);